---
import '../styles/global.css';
// Component Imports
import axios from 'axios'
import Main from '../layouts/main.astro';
import {
  Card,
  CardContent,
  CardDescription,
  CardFooter,
  CardHeader,
  CardTitle,
} from "@/components/ui/card"
import {fetchPersonnel, fetchAddress} from '@/utils/fetchcontacts';
import '../styles/global.css';

import HtmlBody from "@/layouts/htmlbody.astro";

const workers = await fetchPersonnel();
const address = await fetchAddress();

---

<HtmlBody>
  <div class="text-center pt-32 py-12 px-4 sm:px-6 lg:px-8">
    <h1 class="text-4xl font-semibold text-green-800 mb-6 sm:text-5xl">
      Henkil√∂kunta
    </h1>

    <div class="flex flex-wrap justify-center gap-4">
      {workers.map((item) => (
        <div class="w-full sm:w-1/2 lg:w-1/3 p-4">
          <Card class="h-full flex flex-col">
            <CardHeader class="flex-grow">
              <CardTitle>{item.nimi}</CardTitle>
              <CardTitle>{item.nimike}</CardTitle>

              <div class="flex justify-center items-center my-4">
                <img
                  src={item.kuva.url}
                  alt={item.kuva.alt || 'Image'}
                  class="rounded-lg max-w-full h-auto object-cover"
                />
              </div>

              <CardDescription class="text-left">
                <p>{item.kuvaus}</p>
                <br />
                {item.puhelin && (
                  <a href={`tel:${item.puhelin}`} class="block text-green-700 hover:underline">
                    {item.puhelin}
                  </a>
                )}
                {item.email && item.email.length > 0 && (
                  <a href={`mailto:${item.email}`} class="block text-green-700 hover:underline">
                    {item.email}
                  </a>
                )}
              </CardDescription>
            </CardHeader>

            <CardContent class="mt-auto text-left">
              <p>{item.tervehdys}</p>
            </CardContent>
          </Card>
        </div>
      ))}
    </div>

    {address && (
      <section class="mt-12 bg-green-50 border border-green-300 rounded-lg p-4 shadow-sm max-w-2xl mx-auto">
        <h4 class="text-lg font-semibold mb-2 text-green-800">Osoite</h4>
        <p class="text-gray-800">{address.Katuosoite}</p>
        <p class="text-gray-800">
          {address.Postinumero} {address.Toimipaikka}
        </p>
        {address.Lisatiedot && address.Lisatiedot.length > 0 && (
          <p class="italic text-gray-500 mt-2">{address.Lisatiedot}</p>
        )}
      </section>
    )}
  </div>
</HtmlBody>